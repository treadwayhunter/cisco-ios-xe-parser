{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Cisco IOS-XE",
	"patterns": [
		{
			"include": "#keywords"
		},
		{
			"include": "#strings"
		},
		{
			"include": "#comments"
		},
		{
			"include": "#router"
		},
		{
			"include": "#critical"
		},
		{
			"include": "#interfaces"
		},
		{
			"include":"#spanningTree" 
		},
		{
			"include": "#lines"
		},
		{
			"include": "#vlans"
		},
		{
			"include": "#accessLists"
		},
		{
			"include": "#policyEnforcement"
		}
	],
	"repository": {
		"keywords": {
			"patterns": [
				{
					"match": "\\b(?:(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})\\.){3}(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})\\b",
					"name": "entity.name.class"
				},
				{
					"match": "address\\s+ipv4",
					"name": "variable.other"
				},
				{
					"match": "(description)\\s+(.*)",
					"captures": {
						"1": {"name": "constant.character.escape"},
						"2": {"name": "string.other"}
					}
				},
				{
					"match": "\\bip address\\b",
					"name": "variable.other"
				}
			]
		},
		"policyEnforcement": {
			"patterns": [
				{
					"match": "^\\baaa new-model\\b",
					"name": "keyword.control"
				},
				{
					"match": "^\\baaa\\s+authentication\\b",
					"name": "keyword.control"
				},
				{
					"match": "^\\b(aaa)\\s+(authorization)\\b",
					"captures": {
						"1": {
							"name": "keyword.control"
						},
						"2": {
							"name": "keyword.other"
						}
					}
				},
				{
					"match": "^\\b(aaa)\\s+(accounting)\\b",
					"captures": {
						"1": {
							"name": "keyword.control"
						},
						"2": {
							"name": "constant.character.escape"
						}
					}
				},
				{
					"match": "(?<=^aaa\\s+(auth|acc).*group)\\s+([0-9A-Za-z-_\\+]+)\\s+",
					"name": "entity.name.class"
				},
				{
					"match": "(?<=^aaa\\s+group\\s+server\\s+tacacs\\+)\\s+([0-9A-Za-z-_\\+]+)\\s+",
					"name": "entity.name.class"
				},
				{
					"match": "^\\baaa group\\b",
					"name": "keyword.control"
				},
				{
					"match": "^\\baaa\\b",
					"name": "keyword.control"
				},
				{
					"match": "(^\\btacacs\\s+server\\b)\\s+([0-9A-Za-z-_\\+]+)\\s+",
					"captures": {
						"1": {
							"name": "keyword.control"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "^\\btacacs\\b",
					"name": "keyword.control"
				},
				{
					"match": "(\\bserver\\s+name)\\s+([0-9A-Za-z-_\\+]+)\\s+",
					"captures": {
						"1": {
							"name": "variable.other"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "\\b(ip\\s+tacacs\\s+source-interface)\\s+([A-Za-z0-9/]{1,40})?\\b",
					"captures": {
						"1": {
							"name": "variable.other"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "timeout",
					"name": "variable.other"
				},
				{
					"match": "\\bauthentication\\b",
					"name": "keyword.control"
				},
				{
					"match": "\\bdot1x\\b",
					"name": "keyword.control"
				},
				{
					"match": "\\bmab\\b",
					"name": "keyword.control"
				}
			]
		},
		"accessLists": {
			"patterns": [
				{
					"match": "^(\\bip access-list)\\s+(standard|extended)\\s+(.*)\\b",
					"captures": {
						"1": {
							"name": "constant.character.escape"
						},
						"2": {
							"name": "variable.other"
						},
						"3": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "^\\bip access-list\\b",
					"name": "constant.character.escape"
				},
				{
					"match": "^(\\baccess-list\\b)\\s+([0-9]{1,4})",
					"captures": {
						"1": {
							"name": "constant.character.escape"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "^\\baccess-list\\b",
					"name": "constant.character.escape"
				},
				{
					"match": "\\b(ip access-(?:class|group))\\s+(.*)\\s+(in|out)\\b",
					"captures": {
						"1": {
							"name": "constant.character.escape"
						},
						"2": {
							"name": "entity.name.class"
						},
						"3": {
							"name": "variable.other"
						}
					}
				},
				{
					"match": "\\b(access-(?:class|group))\\s+(.*)\\s+(in|out)\\b",
					"captures": {
						"1": {
							"name": "constant.character.escape"
						},
						"2": {
							"name": "entity.name.class"
						},
						"3": {
							"name": "variable.other"
						}
					}
				},
				{
					"match": "\\baccess-(class|group)\\b",
					"name": "constant.character.escape"
				},
				{
					"match": "\\bpermit\\b",
					"name": "variable.other"
				},
				{
					"match": "\\bdeny\\b",
					"name": "string.regexp"
				},
				{
					"match": "\\bremark\\b",
					"name": "constant.numeric"
				}
			]
		},
		"vlans": {
			"patterns": [
				{
					"match": "\\bvlan\\b",
					"name": "keyword.other.vlans.cisco-iosxe"
				}
			]
		},
		"lines": {
			"patterns": [
				{
					"match": "(?i)(^line\\s+vty)(\\s+[0-9]{1,2}\\s+[0-9]{1,2})",
					"captures": {
						"1": {
							"name": "keyword.other"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "(?i)(^line (?:con|aux))\\s+([0-9])",
					"captures": {
						"1": {
							"name": "keyword.other"
						},
						"2": {
							"name": "entity.name.class"
						}
					}
				},
				{
					"match": "^line",
					"name": "keyword.other"
				}
			]
		},
		"interfaces": {
			"patterns": [
				{
					"match": "\\b((?i)(hu|hundredgig|hundredgigabit)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.tengigabitethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(fo|fortygig|fortygigabitethernet)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.fortygigabitethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(twe|twentyfivegig|twentyfivegigabit)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.twentyfivegigabitethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(te|ten|tengigabitethernet)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.tengigabitethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(g|gi|gigabit|gigabitethernet)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.gigabitethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(e|eth|ethernet)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.ethernet.cisco-iosxe"
				},
				{
					"match": "\\b((?i)(fa|fastethernet)\\s*[0-9](?:/[0-9]{1,2})?{1,2}(?:-[0-9]{1,2})?)\\b",
					"name": "entity.name.class.interfaces.ethernet.cisco-iosxe"
				},
				{
					"match": "\\b^(int|interface)\\b",
					"name": "keyword.other.interfaces.interface.cisco-iosxe"
				},
				{
					"match": "\\b(ran|range)\\b",
					"name": "constant.character.escape"
				},
				{
					"match": "\\baccess(?!-)\\b",
					"name": "variable.other"
				},
				{
					"match": "\\bvoice\\b",
					"name": "variable.other"
				},
				{
					"match": "(?<!description.*)\\btrunk\\b",
					"name": "keyword.control"
				},
				{
					"match": "\\bswitchport\\b",
					"name": "variable.other"
				},
				{
					"match": "\\baccess-session\\b",
					"name": "keyword.control"
				},
				{
					"match": "\\bstorm-control\\b",
					"name": "constant.sha.git-rebase"
				},
				{
					"match": "(?<!-)\\b(?i)(po|port-channel)[0-9]+(\\.[0-9]+)*\\b",
					"name": "entity.name.class"
				},
				{
					"match": "\\b(channel-group)\\s+([0-9]+)\\b",
					"captures": {
						"1": {"name": "variable.other"},
						"2": {"name": "entity.name.class"}
					}
				},
				{
					"match": "\\b(?<=channel-group.*)(active|passive)\\b",
					"name": "keyword.control"
				},
				{
					"match": "\\b(?<=channel-group.*)(?i)(on|auto|desirable)\\b",
					"name": "string.regexp"
				},
				{
					"match": "\\b(?i)(tun|tunnel)\\s*[0-9]+\\b",
					"name": "entity.name.class"
				},
				{
					"match": "\\btunnel\\b",
					"name": "variable.other"
				},
				{
					"match": "\\b(?i)(lo|loopback)[0-9]+\\b",
					"name": "entity.name.class"
				},
				{
					"match": "\\bip (mtu|tcp)\\b",
					"name": "variable.other"
				},
				{
					"match": "\\bVlan[0-9]+\\b",
					"name": "entity.name.class"
				},
				{
					"match": "\\bencapsulation\\b",
					"name": "keyword.control"
				}
			]
		},
		"spanningTree": {
			"patterns": [
				{
					"match": "\\bspanning-tree\\b",
					"name": "support.function"
				}
			]
		},
		"critical": {
			"patterns": [
				{
					"match": "\\s*\\bno\\b",
					"name": "string.regexp.critical.no.cisco-iosxe"
				},
				{
					"match": "^default",
					"name": "string.regexp.critical.default.cisco-iosxe"
				},
				{
					"match": "\\b(shut|shutdown)\\b",
					"name": "string.regexp.critical.default.cisco-iosxe"
				},
				{
					"match": "(key)\\s+(.*)",
					"captures": {
						"1": {
							"name": "string.regexp"
						},
						"2": {
							"name": "constant.character.escape"
						}
					}
				}
			]
		},
		"router": {
			"patterns": [
				{
					"match": "(^router)\\s+(rip|ospf|eigrp|bgp)\\s+([0-9]{1,10})",
					"captures": {
						"1": {
							"name": "keyword.other.router.cisco-iosxe"
						},
						"2": {
							"name": "keyword.other.router.protocol.cisco-iosxe"
						},
						"3": {
							"name": "entity.name.class.router.as.cisco-iosxe"
						}
					}
				},
				{
					"match": "(ip)\\s+(rip|ospf|eigrp|bgp)\\s+([0-9]{1,10})",
					"captures": {
						"1": {
							"name": "keyword.other"
						},
						"2": {
							"name": "keyword.other.router.protocol.cisco-iosxe"
						},
						"3": {
							"name": "entity.name.class.router.as.cisco-iosxe"
						}
					}
				},
				{
					"match": "(^router)\\s+(rip|ospf|eigrp|bgp)",
					"captures": {
						"1": {
							"name": "keyword.other.router.cisco-iosxe"
						},
						"2": {
							"name": "keyword.other.router.protocol.cisco-iosxe"
						}
					}
				},
				{
					"match": "^router",
					"name": "keyword.other.router.cisco-iosxe"
				},
				{
					"match": "passive-interface",
					"name": "variable.other.router.passive-interface.cisco-iosxe"
				},
				{
					"match": "\\brouter-id\\b",
					"name": "variable.other"
				},
				{
					"match": "\\bnetwork\\b",
					"name": "variable.other"
				}
			]
		},
		"strings": {
			"name": "string.quoted.double.cisco-iosxe",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.cisco-iosxe",
					"match": "\\\\."
				}
			]
		},
		"comments": {
			"patterns": [
				{
					"name": "comment.line.exclamation.cisco.iosxe",
					"match": "^\\s*!.*$"
				}
			]
		}
	},
	"scopeName": "source.cisco-iosxe"
}